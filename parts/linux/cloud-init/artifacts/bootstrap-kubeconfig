apiVersion: v1
kind: Config
clusters:
- name: localcluster
    cluster:
    certificate-authority: /etc/kubernetes/certs/ca.crt
    server: https://{{GetKubernetesEndpoint}}:443
users:
- name: kubelet-bootstrap
    user:
    {{- if EnableSecureTLSBootstrapping }}
    exec:
        apiVersion: client.authentication.k8s.io/v1
        command: /opt/azure/tlsbootstrap/tls-bootstrap-client
        args:
        - bootstrap
        - --next-proto=aks-tls-bootstrap
        {{- if GetCustomSecureTLSBootstrapAADServerAppID}}
        - --aad-resource={{GetCustomSecureTLSBootstrapAADServerAppID}}
        {{- else}}
        - --aad-resource=6dae42f8-4368-4678-94ff-3960e28e3630
        {{- end}}
        interactiveMode: Never
        provideClusterInfo: true
    {{- else }}
    token: "{{GetTLSBootstrapTokenForKubeConfig}}"
    {{- end }}
contexts:
- context:
    cluster: localcluster
    user: kubelet-bootstrap
    name: bootstrap-context
current-context: bootstrap-context