syntax = "proto3";
package aksnodeconfig.v1;

option go_package = "github.com/Azure/agentbaker/aks-node-controller/pkg/gen/aksnodeconfig/v1;aksnodeconfigv1";

// Represents localdns configuration for agentpool nodes.
message LocalDNSProfile {
  bool enable_local_d_n_s = 1;
  optional int32 c_p_u_limit_in_milli_cores = 2;
  optional int32 memory_limit_in_m_b = 3;
  map<string, LocalDNSOverrides> vnet_d_n_s_overrides = 4;
  map<string, LocalDNSOverrides> kube_d_n_s_overrides = 5;
}

// Represents DNS override settings for both VnetDNS and KubeDNS traffic.
// VnetDNS overrides apply to DNS traffic from pods with dnsPolicy:default or kubelet.
// KubeDNS overrides apply to DNS traffic from pods with dnsPolicy:ClusterFirst.
message LocalDNSOverrides {
  string query_logging = 1;
  string protocol = 2;
  string forward_destination = 3;
  string forward_policy = 4;
  optional int32 max_concurrent = 5;
  optional int32 cache_duration_in_seconds = 6;
  optional int32 serve_stale_duration_in_seconds = 7;
  string serve_stale = 8;
}
