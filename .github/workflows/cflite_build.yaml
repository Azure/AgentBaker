name: ClusterFuzzLite continuous builds
on:
  push:
    branches:
      - ace/fuzzLite  # Use your actual default branch here.

permissions: read-all
jobs:
  Build:
   runs-on: ubuntu-latest
   concurrency:
     group: ${{ github.workflow }}-${{ matrix.sanitizer }}-${{ github.ref }}
     cancel-in-progress: true
   strategy:
     fail-fast: false
     matrix:
      sanitizer: [address, undefined]  # Override this with the sanitizers you want.
   steps:
   - name: Harden Runner
     uses: step-security/harden-runner@eb238b55efaa70779f274895e782ed17c84f2895 # v2.6.1
     with:
       egress-policy: audit

   - name: Build Fuzzers (${{ matrix.sanitizer }})
     id: build
     uses: google/clusterfuzzlite/actions/build_fuzzers@884713a6c30a92e5e8544c39945cd7cb630abcd1 # v1
     with:
        language: go # Change this to the language you are fuzzing.
        sanitizer: ${{ matrix.sanitizer }}
        parallel-fuzzing: True
        minimize-crashes: True
        upload-build: true
        storage-repo: https://${{ secrets.PERSONAL_ACCESS_TOKEN }}@github.com/alexeldeib/agentbaker-corpus.git
        storage-repo-branch: main   # Optional. Defaults to "main"
        storage-repo-branch-coverage: gh-pages  # Optional. Defaults to "gh-pages".

