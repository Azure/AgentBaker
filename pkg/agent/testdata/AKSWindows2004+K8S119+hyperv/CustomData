<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "19.03.14"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

# To support newer Windows OS version, we need to support set ContainerRuntime,
# ContainerdWindowsRuntimeHandlers and DefaultContainerdWindowsSandboxIsolation per agent pool but
# current code does not support this. Below is a workaround to set contianer
# runtime variables per Windows OS version.
#
# Set default values for container runtime variables for AKS Windows 2004
if ($([System.Environment]::OSVersion.Version).Build -eq "19041") {
    $global:ContainerRuntime = "containerd"
    $global:ContainerdWindowsRuntimeHandlers = "17763,19041"
    $global:DefaultContainerdWindowsSandboxIsolation = "process"
}

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "aks-subnet"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-36873793"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "10.240.0.0/16"
$global:KubeServiceCIDR = "10.0.0.0/16"
$global:VNetCIDR = "10.0.0.0/8"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2004-17763.1457.201019"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=10.0.0.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "false"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("false");

# Calico
$global:WindowsCalicoPackageURL = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"

try
{
    # Set to false for debugging.  This will output the start script to
    # c:\AzureData\CustomDataSetupScript.log, and then you can RDP
    # to the windows machine, and run the script manually to watch
    # the output.
    if ($true) {
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment $TargetEnvironment 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        if ($global:NetworkPlugin -eq "azure") {
            Write-Log "Installing Azure VNet plugins"
            Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
                -AzureCNIBinDir $global:AzureCNIBinDir `
                -VNetCNIPluginsURL $global:VNetCNIPluginsURL

            Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
                -KubeDnsSearchPath $global:KubeDnsSearchPath `
                -KubeClusterCIDR $global:KubeClusterCIDR `
                -KubeServiceCIDR $global:KubeServiceCIDR `
                -VNetCIDR $global:VNetCIDR `
                -IsDualStackEnabled $global:IsDualStackEnabled

            if ($TargetEnvironment -ieq "AzureStackCloud") {
                GenerateAzureStackCNIConfig `
                    -TenantId $global:TenantId `
                    -SubscriptionId $global:SubscriptionId `
                    -ResourceGroup $global:ResourceGroup `
                    -AADClientId $AADClientId `
                    -KubeDir $global:KubeDir `
                    -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                    -NetworkAPIVersion $NetworkAPIVersion `
                    -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                    -IdentitySystem "azure_ad"
            }
        }
        elseif ($global:NetworkPlugin -eq "kubenet") {
            Write-Log "Fetching additional files needed for kubenet"
            if ($useContainerD) {
                # TODO: CNI may need to move to c:\program files\containerd\cni\bin with ContainerD
                Install-SdnBridge -Url $global:ContainerdSdnPluginUrl -CNIPath $global:CNIPath
            } else {
                Update-WinCNI -CNIPath $global:CNIPath
            }
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime

        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Register-NodeLabelSyncScriptTask
        Update-DefenderPreferences

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
    }
    else
    {
        # keep for debugging purposes
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AgentKey $AgentKey -AADClientId $AADClientId -AADClientSecret $AADClientSecret -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"
    }
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

