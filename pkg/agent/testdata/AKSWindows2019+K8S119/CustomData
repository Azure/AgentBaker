<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "19.03.14"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "aks-subnet"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-36873793"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "10.240.0.0/16"
$global:KubeServiceCIDR = "10.0.0.0/16"
$global:VNetCIDR = "10.0.0.0/8"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2019-17763.1577.201111"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=10.0.0.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "false"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("false");

# Calico
$global:WindowsCalicoPackageURL = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"
$fipsEnabled = [System.Convert]::ToBoolean("false")

try
{
    # Set to false for debugging.  This will output the start script to
    # c:\AzureData\CustomDataSetupScript.log, and then you can RDP
    # to the windows machine, and run the script manually to watch
    # the output.
    if ($true) {
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment $TargetEnvironment 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        if ($global:NetworkPlugin -eq "azure") {
            Write-Log "Installing Azure VNet plugins"
            Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
                -AzureCNIBinDir $global:AzureCNIBinDir `
                -VNetCNIPluginsURL $global:VNetCNIPluginsURL

            Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
                -KubeDnsSearchPath $global:KubeDnsSearchPath `
                -KubeClusterCIDR $global:KubeClusterCIDR `
                -KubeServiceCIDR $global:KubeServiceCIDR `
                -VNetCIDR $global:VNetCIDR `
                -IsDualStackEnabled $global:IsDualStackEnabled

            if ($TargetEnvironment -ieq "AzureStackCloud") {
                GenerateAzureStackCNIConfig `
                    -TenantId $global:TenantId `
                    -SubscriptionId $global:SubscriptionId `
                    -ResourceGroup $global:ResourceGroup `
                    -AADClientId $AADClientId `
                    -KubeDir $global:KubeDir `
                    -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                    -NetworkAPIVersion $NetworkAPIVersion `
                    -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                    -IdentitySystem "azure_ad"
            }
        }
        elseif ($global:NetworkPlugin -eq "kubenet") {
            Write-Log "Fetching additional files needed for kubenet"
            if ($useContainerD) {
                # TODO: CNI may need to move to c:\program files\containerd\cni\bin with ContainerD
                Install-SdnBridge -Url $global:ContainerdSdnPluginUrl -CNIPath $global:CNIPath
            } else {
                Update-WinCNI -CNIPath $global:CNIPath
            }
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime

        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Register-NodeLabelSyncScriptTask
        Update-DefenderPreferences

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Enable FIPS-mode
        Enable-FIPSMode $fipsEnabled

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
    }
    else
    {
        # keep for debugging purposes
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AgentKey $AgentKey -AADClientId $AADClientId -AADClientSecret $AADClientSecret -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"
    }
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

