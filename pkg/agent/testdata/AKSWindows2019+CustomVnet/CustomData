<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "20.10.6"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "subnet2"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-07752737"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "172.17.0.0/24"
$global:KubeServiceCIDR = "172.17.255.0/24"
$global:VNetCIDR = "172.17.0.0/16"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,kubernetes.azure.com/agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/storageprofile=managed,kubernetes.azure.com/storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2019-17763.1577.201111"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=172.17.255.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "false"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("false");

# Calico
$global:WindowsCalicoPackageURL = "";

# GMSA
$global:WindowsGmsaPackageUrl = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"
$fipsEnabled = [System.Convert]::ToBoolean("false")
$windowsSecureTlsEnabled = [System.Convert]::ToBoolean("false");

try
{
        # Exit early if the script has been executed
        if (Test-Path -Path $CSEResultFilePath -PathType Leaf) {
            Write-Log "The script has been executed before, will exit without doing anything."
            return
        }

        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Write-Log "Remove `"NT AUTHORITY\Authenticated Users`" write permissions on files in c:\k"
        icacls.exe "c:\k" /inheritance:r
        icacls.exe "c:\k" /grant:r SYSTEM:`(OI`)`(CI`)`(F`)
        icacls.exe "c:\k" /grant:r BUILTIN\Administrators:`(OI`)`(CI`)`(F`)
        icacls.exe "c:\k" /grant:r BUILTIN\Users:`(OI`)`(CI`)`(RX`)
        Write-Log "c:\k permissions: "
        icacls.exe "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment $TargetEnvironment 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        Write-Log "Installing Azure VNet plugins"
        Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
            -AzureCNIBinDir $global:AzureCNIBinDir `
            -VNetCNIPluginsURL $global:VNetCNIPluginsURL

        Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
            -KubeDnsSearchPath $global:KubeDnsSearchPath `
            -KubeClusterCIDR $global:KubeClusterCIDR `
            -KubeServiceCIDR $global:KubeServiceCIDR `
            -VNetCIDR $global:VNetCIDR `
            -IsDualStackEnabled $global:IsDualStackEnabled

        if ($TargetEnvironment -ieq "AzureStackCloud") {
            GenerateAzureStackCNIConfig `
                -TenantId $global:TenantId `
                -SubscriptionId $global:SubscriptionId `
                -ResourceGroup $global:ResourceGroup `
                -AADClientId $AADClientId `
                -KubeDir $global:KubeDir `
                -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                -NetworkAPIVersion $NetworkAPIVersion `
                -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                -IdentitySystem "azure_ad"
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime
        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Update-DefenderPreferences

        if ($windowsSecureTlsEnabled) {
            Write-Host "Enable secure TLS protocols"
            try {
                . C:\k\windowssecuretls.ps1
                Enable-SecureTls
            }
            catch {
                Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_ENABLE_SECURE_TLS -ErrorMessage $_
            }
        }

        Enable-FIPSMode -FipsEnabled $fipsEnabled
        if ($global:WindowsGmsaPackageUrl) {
            Write-Log "Start to install Windows gmsa package"
            Install-GmsaPlugin -GmsaPackageUrl $global:WindowsGmsaPackageUrl
        }

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

