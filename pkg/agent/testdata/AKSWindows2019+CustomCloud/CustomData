<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "20.10.6"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "aks-subnet"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-36873793"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "10.240.0.0/16"
$global:KubeServiceCIDR = "10.0.0.0/16"
$global:VNetCIDR = "10.0.0.0/8"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2019-17763.1577.201111"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=10.0.0.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "false"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("true");

# Calico
$global:WindowsCalicoPackageURL = "";

# GMSA
$global:WindowsGmsaPackageUrl = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"
$fipsEnabled = [System.Convert]::ToBoolean("false")
$windowsSecureTlsEnabled = "false"

try
{
    # Set to false for debugging.  This will output the start script to
    # c:\AzureData\CustomDataSetupScript.log, and then you can RDP
    # to the windows machine, and run the script manually to watch
    # the output.
    if ($true) {
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment "AzureStackCloud" 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        
        $azureStackConfigFile = [io.path]::Combine($global:KubeDir, "azurestackcloud.json")
        $envJSON = "eyJOYW1lIjoiQXp1cmVTdGFja0Nsb3VkIiwibWNyVVJMIjoibWNyLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQiLCJyZXBvRGVwb3RFbmRwb2ludCI6Imh0dHBzOi8vcmVwb2RlcG90LmF6dXJlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvdWJ1bnR1IiwibWFuYWdlbWVudFBvcnRhbFVSTCI6Imh0dHBzOi8vcG9ydGFsLmF6dXJlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwic2VydmljZU1hbmFnZW1lbnRFbmRwb2ludCI6Imh0dHBzOi8vbWFuYWdlbWVudC5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwicmVzb3VyY2VNYW5hZ2VyRW5kcG9pbnQiOiJodHRwczovL21hbmFnZW1lbnQuYXp1cmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJhY3RpdmVEaXJlY3RvcnlFbmRwb2ludCI6Imh0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwia2V5VmF1bHRFbmRwb2ludCI6Imh0dHBzOi8vdmF1bHQuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJncmFwaEVuZHBvaW50IjoiaHR0cHM6Ly9ncmFwaC5jbG91ZGFwaS5taWNyb3NvZnQuZmFrZWN1c3RvbWNsb3VkLyIsInN0b3JhZ2VFbmRwb2ludFN1ZmZpeCI6ImNvcmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsInNxbERhdGFiYXNlRE5TU3VmZml4IjoiZGF0YWJhc2UuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsImtleVZhdWx0RE5TU3VmZml4IjoidmF1bHQuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsInJlc291cmNlTWFuYWdlclZNRE5TU3VmZml4IjoiY2xvdWRhcHAuYXp1cmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJjb250YWluZXJSZWdpc3RyeUROU1N1ZmZpeCI6Ii5henVyZWNyLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQiLCJjb3Ntb3NEQkROU1N1ZmZpeCI6ImRvY3VtZW50cy5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwidG9rZW5BdWRpZW5jZSI6Imh0dHBzOi8vbWFuYWdlbWVudC5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwicmVzb3VyY2VJZGVudGlmaWVycyI6e319"
        [io.file]::WriteAllBytes($azureStackConfigFile, [System.Convert]::FromBase64String($envJSON))

        Get-CACertificates
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        if ($global:NetworkPlugin -eq "azure") {
            Write-Log "Installing Azure VNet plugins"
            Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
                -AzureCNIBinDir $global:AzureCNIBinDir `
                -VNetCNIPluginsURL $global:VNetCNIPluginsURL

            Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
                -KubeDnsSearchPath $global:KubeDnsSearchPath `
                -KubeClusterCIDR $global:KubeClusterCIDR `
                -KubeServiceCIDR $global:KubeServiceCIDR `
                -VNetCIDR $global:VNetCIDR `
                -IsDualStackEnabled $global:IsDualStackEnabled

            if ($TargetEnvironment -ieq "AzureStackCloud") {
                GenerateAzureStackCNIConfig `
                    -TenantId $global:TenantId `
                    -SubscriptionId $global:SubscriptionId `
                    -ResourceGroup $global:ResourceGroup `
                    -AADClientId $AADClientId `
                    -KubeDir $global:KubeDir `
                    -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                    -NetworkAPIVersion $NetworkAPIVersion `
                    -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                    -IdentitySystem "azure_ad"
            }
        }
        elseif ($global:NetworkPlugin -eq "kubenet") {
            Write-Log "Fetching additional files needed for kubenet"
            if ($useContainerD) {
                # TODO: CNI may need to move to c:\program files\containerd\cni\bin with ContainerD
                Install-SdnBridge -Url $global:ContainerdSdnPluginUrl -CNIPath $global:CNIPath
            } else {
                Update-WinCNI -CNIPath $global:CNIPath
            }
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime
        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Update-DefenderPreferences

        if ($windowsSecureTlsEnabled) {
            Write-Host "Enable secure TLS protocols"
            try {
                . C:\k\windowssecuretls.ps1
                Enable-SecureTls
            }
            catch {
                Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_ENABLE_SECURE_TLS -ErrorMessage $_
            }
        }

        Enable-FIPSMode -FipsEnabled $fipsEnabled
        Install-GmsaPlugin -GmsaPackageUrl $global:WindowsGmsaPackageUrl

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
    }
    else
    {
        # keep for debugging purposes
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AgentKey $AgentKey -AADClientId $AADClientId -AADClientSecret $AADClientSecret -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"
    }
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

