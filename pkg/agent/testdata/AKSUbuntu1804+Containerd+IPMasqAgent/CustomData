#cloud-config

write_files:
- path: /opt/azure/containers/provision_source.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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



- path: /opt/azure/containers/provision_source_distro.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/9yW32/aSBDH3/1XTF2LQqWNS6q8gKjKKe61EiIn0ionJTlrscf2CrPr7o8kVcn/ftrFNRDwldw9nO78hHe/O5r5zocdv3wRzhkP51QVnodJIcC/FEYmjOeQKIwLLCuUKk6Z0lKcqAIyIeHL3HBtfM/zaKWXVC6uxhPGzcM4R667PfjuAQDcU6bjTMiYVjouRbJQblmilt+SZRqzLM4oK41E6J++gTM4PQNaaWIDQtCHe1raoNQGhdUKbtxxlsH1NfhB34fRCPxClKkPt7dD0AVyp7APPjANQTSbxR8vJufx1Xjyafrl9/Gv0fSz02D5JI7hP400iybR+DJqiZgx79Hz9mve2FGwEiEzCiWEd1SGJZuHabXIQ6vbLNFKhyVTWm2tJzQp0O1QmRTsDuvNd2GKdyE3ZQmn7zr9IaRik7jt5qsryrRtpm2bxBKpQhCZ9Rlceq8avSoRK3jr3lPB0Xu03Y1z1LGpUqqxqcR2kKEa9d+4V6taK2JhdGX0KNTLymZLctRkvXUijF77JCQwYByCrsKv0IegDtfbyb4FnnVHKiE1nEe/fBpP4w+zi+nnaHo+4oIzrlHSRLM7bNTWYSAkETxjuWWNUCAkEzJBt5hi1mjrlIFkQL4B40rTsmx2X0D3h2Bdk/McVqARIdhzAVaQS6yAROD/0b2+im4HJ697q+41RrdSnrzuBX4POp0aa/skVB+K0+nAXCJdbP4D7eJm2+INAQOCXxuH4SnbdTON5NDf2FsqrGE4axYztuGigSt6wMRoTOGJLQEDzZao2m6BDVi1xXtkBf3h+qDLYxScDl1EYfQoeDsEVbDM+bL74z/DV102EAHn1SIfDC4qzQRXg8HI3z7rbiRCuCD1CSIxEcsl8lRZQoPv7x9b8Phn/d9RrFkINv3Y2d29I54JTGNEe403fvD+xm+YGv4cqsrIfP+y+p8j5Yo+Eqh/H5zj6Khr+jsM2O+V2FS5pOkPFHamltVtaw5OLisgtaCeX0eg0ILB8Qgc2/72adV8RalC3NvvGre6Nb+2K7OHnw6yA9Y8b5w10+lQpH3w/kruHUnlDo97Q8wRV/N2mLYdT7ZG2EHOXn6MJr9Fs8vo4oP3ZwAAAP//G8rI3kQLAAA=


- path: /opt/azure/containers/provision_start.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/5SSX4vTQBTF3/MpDmG0CXaM1bdCK0s6SAVbaVLYByFMJ9c2GjNx/ixV1+8u6fYf7lpqniacO7/DnHOTVdUkK2k3SHTrEvnTG0qUbpysGjI2aY2+q2ylm5d2g/EYyZ00Sa3Xh8naW0eGn8Zqvcbr8fNBIG6neZHOJ2LE3gb2h3X0TbkanDeat3JNBryGddJ5i69+RTW5awy4ssS1d613J6/5Mv+4zEcsUtL9N+EeG5IleIM3r+Igy28WeZFPP4gRi0htNEL2gA9xD+UdeIlevwf+GXxwvDyIgzQThbgV6TKfzmfFZLm46Q4HCosiFpXSEV48szE49n+8RMhOpuFOjuM4ePBOM4FcO1lDbEl5V+kGE29kdxiypy0BS0o3pQ2vCpQOYF7uwfa8xb/p2bUx/4MbB8H7bD4rsnwxnb0bsQhfvnfhfwrw6ONcmjVIIWTHdQovTOr2rK0LQIPwol7uDB+9/Ok7vV9iW7lUlzQEI9XHfLdbQzDd9iGM0aYTTB9pJo4tHkq0nVb+7mHfODsLJ6Bt5XB6+p8AAAD//9CDYZutAwAA

- path: /opt/azure/containers/provision.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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

- path: /opt/azure/containers/provision_installs.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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


- path: /opt/azure/containers/provision_installs_distro.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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


- path: /opt/azure/containers/provision_configs.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/8xae3PbOJL/X58Cx+h2k7qlqGQys4lv7CqagrMcS6SGj0xy6y0WREI2xnxoANC2NvZ3vwJfIiWSojZbV5c/GJno/vUDje4GwFf/oaxIrKwQuxsZ5gx6ujGDX87Hr+8SxmMUYfAMOCIhkH3w7k1OYqgLWKN4Mxr5SbwmtynFahCR2GWYvn7zbQQAAP4dusVAhkB+C2Q9e0ZgCuQF+Cj+AWn8TZ0tdMO1ofUi1VnC/bGXmhwb+xRzVkpRl7oNrc/Q8paW/ll1oHcNv3pL1fnbuaRg7iv36QrTGHPMFB9TzhS0IQzTB0wn93iby+VJ6t9lQjvRKg2jJADTn6bTgeTJYwxokvAz8TjKkzFp6mBbfNRiRAt/q/Z9dAdqtxNn1NDRZt6Jk4C5H3TOQh9gqyUDGMga/P3vQP5nZotpL0zbcy39RQL/+Md/A36H44yqNF2odyYeA9HXpOYKba5DwznJFX5IcMy7XNEB2O2KYwwHs3uEa2fbEp44yRuM6fjbLr+8dBnZitxtYh/59851H3Zjpoug0KDl6Fe6JsgHBr1PeU/Q7wPuueH9+8EM7TPdzXUQxafYVkRxh20dgN22HWPojeJe27IJPsWywyjuMLIVudvEfvJ2A7t4MiaGOfivp+wn9u+SzoLzIoFnsEIM//QeyHKA/STA4GJQTStxmxWhG7C7zJRIHQm2G3JARm5gH2a2I9j9CbSBnU3HccS+nNLmh9oED/NDRxS1+WE4dv8SPPSDIBziiBbAl9EIxyyl2Fpqr9+AvLtjW8Zx5PMQxmgVYjUObI4oB3Tjr0gcgOdngJ8IB2NoWZ791XbgQnPmnu2oluNdqfr8GIrMOOJDcOot6HW6wiHmdpbKNUx5pe+1ewnn0Dm1G7rPAfcboj004bQTYLIMleEkGxwzFoJbHFOGgJykHIyPqAreTd9/aHBT/AeQY/wI5Kcfpx+BHKAtA3/9YToF8j3eHgdsFVvZBGSWrn4HkqIZ50WmFZuNveb/+gM78PXgXrmrx+oCam0+jhIfJO0ejv0djHs517UTNjCHRagTrLUGHafu274csOTm/I9rQe8X2zQ6jED/TCme/M6SeF/3Jmf7jquD5lDPA8Ku+tgyP90p7Mj0t9TcykuDSm7rNGQPQaFrUEg2NH2pzsvkbEPNgs75+NsRCkW5uVFubm5uXv5teJLAk3I8H3Hw888AmleFUQcTkC9byQ+TNJDOgKSKQFimq5D4WvbuLzkBxzGKuZ7RjL850FANx9NnL+U4S1fMp2TDSRKXVLZ7aWuWvnR006jTIhRo2bqvCLuMamPKzxqOMObeqJgpZklKffyJJukmZ7WgbbqWBr1PlukuK8ow8ZGwISeam5oqtK+GHyJnu8H54OeF53xdwroLYswNFOHKfKOmA8N+SgnfZjrsqAzo/GZa10Jj19Kdr3v6PDQgP+uW46pzr2BqUFmHNu6Rex020yTl2BFVeCfJMl0Heo56Od8ZuKEkQnSrPiASohUJCd/ade2Wlr5Qra+e+lnV5+qlPhfm2DUXFAC2j0Lcymlr6hw2WLLAXNLkgQSYXiL/PlmvF0lQ8Glz050tLfOzPoOWd6lq1+bVlbcwZ7AXQDoDHbwvPVwW5pRg1s3sWdCxdGj3gcCnTRLjmPegwC9L04CG0wczS2kZpl0wM9fKY7cH5hfCOaY9IL/ojgOtVggLcTwnEWkzxVIdONcXersNFeevS7uP2ft12e7LCuAy9e9xrwLepatdw+N6/EYJx8eU8X6zdAcOUek4XK5XEzFleIFidIsDPcAxJ3wLnziOWTnRrg29hWqon+DM02fQcMQCg18caNi1iU4Zpipj5Dbe4eizfMG4NrQ81bb1T0Ydo5ZnU4b1mHEU+3iBOQoQR5Vs3bAd1dCgt4COOlMd9aXKmii4RKFgovZ9WiZPdeZdqnPBYXn2tVvJCAgT2cZM+SpJ48A2VCeT0eSY6bZIP57pOpema8w8QVdKxE9+mAZ4gRjH9Iomkc1RHCAazC8zKPhFm7sz4S7bgZZ3ZZkLsXMwZqo18+aXL1VGyqfvM0rDWj66XtheNWefVXfuFI1vwRahJxKl0bxmtpWGWEvSYmUv1C/6wl14wqLKIMudQ08z3d3SLsVf420p/P4Dkw5HP2NaRIEkmm9oXlWdk/xUO187khPBOZAe3h2cuQmgAMgESEpfzlICCXQ3jsOw8owzAKk80+ve4DU2IZqhV5uQ7EExp1s/Cjyy9taIhCnF4O27KfgRvPsRREmwockKgxX1YszXJOSYNjecC1M48RLudqxZHynHQKozSeAityRKgjTETBZLYRIodZqJ0LJpjGbo+jIruSxXec+WcrCyqZrespYv5+4n3cinNHNdy6xGD2CsGbp3qRveTLeUt1M597IQFRLG82HNNK70TxlFxZp3+KLB3yc5AKl4DnU057omeuzzcyD5KCR+0qJlFTF/Zq+kKKvt0oqS4BZL1d+cophtEBWV89Xtn09QCof9akli2rsG4yTO/Ar+9Kc9jHI9nYOGbv/X1q1J9VNhKxIreMWzwAEyBzHiQJYr+jURUVbk3rcfpu/t7AgmEI1j+ICDKtZCBuSQ0zyuaTZaC2HE2wfybdasEx4QBtYoZHgC7Huy2ZD4diJyWX7ApCUxRyTGtFQjf+3gEG8SyoMRAI+IcG+dUG9NwmwtT8HbXJX8LCko/lf8Cmsi9uTEx5NAwU/Y9xhHlGcqNxf7lT6H3m+qo/3Nc/QFNF2nV95OgJIv2glPovC7INmW+TycBMrbt3JN/4Gq9ia7HBrIcu6eg3M1zZl7FhSValQ7lgOEycjn5AEDWf4jJZiDIPHvMRVr4XVF5hXxBN5NwQ/TTGhB1nJ8N/NmpnYtmgHHXGaJ9c2o+yRw54ZBR4F7AVNF8+Cw4SVrGTUDHN+tfYV2gvKLJCY8oXYuvlnPNNNwVN2A1sxbmIbumDunCnVy/c77l4Mc5QImnESYdntnPEjYIPf0IJ2icDEj/5rKg5U9HolNDw47oh6Vh+hFB3NwWDqDV1mLuXNIgNeiIS0Pj3vMbsMYZKtgLEpMLvcBUSUkq1Jm9n+e3Y6Ir6EMlixUtlxDvC4LXX5UVCiTbHjeEO6CoTpKn7C7AQ7pRv+uUCh0aGJU5+fNK47a42U0egWcOwzSTYA4luMkwHKIVjhkVbbJh5hoH0A+BNYJzf7ctclAcE6AlcYMpDEnIWCp72PG1mkIkhhkFS7dFBHnZpBGEuB5Bvj/I/Tc5Ux1oJfdJ8zVSzi3B0x+m+P64qBfyL+s57Hc1T2/J+r678pdhwoNy1p5ANlZ71CFTdEtNPJGo3v5+PGjnP8ho3u2aw7b7T6EG2RqW7fz7n1rs7Oz5JckpTHamfJtt0PIGlebJxTd4vON2GkzLlrxfYoMcYGeXIbP337aH7bEcoxw5/hVQh8RDZzE3rIwuT3fYpaTvICLi2ZD8nuua7DzX9fsFhxyyXHK3F5/YKLrpkm4DFGM61vNsQUvTdOx4K+ubsGZQBW7H8OsDmOyfSenqdge7e14KOYprTbxR/fieQ1x5uDdhRLgByVOwxD4Yco4pjKJ18lerv1gi9xu6ManKijE5plixLMKu0AxWWPGZ4Q20t1CNfQraDsz3TrfP3uICp58Mx7dB4QCeZOrVuMTgh4pyeVoWW1siMgDORNwl0RYGVffSyoTIW2PMFs/4wajUqu4TTUqktr93LiJVbt220k+2/1sAxpIXoOPkgD8dTptB6sODVpYD675RrIsj9CGFIdbZ+Dh7aiYeHY2kssgOMuxMeVkTXyRzFDK7xJK+FYOEEdn4EYaa2r9+4UbqZBIHzA9a7Qp+aXeCIAYRThjLY8If50ZN9JIlBz8xHMF8t+FAoU2hyxiNGWHQzIKIhJnBF3CUio2/XIp6JDinsTBGchjbSSEZIq1wdWkZcoUSpMMv+a8ymU1pxy6rmC8x9tWhmv49UYaSeCic6blp92Zlpa7Tk15wnwUYqoGQRJXS0ebu5kVquuY2Q2Q5amzmWnUCkz9nFDwMqXMEKgClQO8CZNthGM+2aIo7Nss9EkcVm6LQ072/HPuKn128Tx+nQX2uOc+s7pufvN8Kx1RpF2Qjf0BkvIL0O+RxtJVw6bmZe73IBd3yTXw6j75e2Dp7Q6wedN5EmoVtaqma0kcY58newGratnxnAE1sc3ULJjdo6hz+3z8ekNJzNdA+nYjFYER3Ehi+fwnu5H+Asq3+S12c6S8Y2++bd6sN8fyA5oZoZmSWxgHm4TE3KVhTnfH+YadKUqY3JJ4EhGfJixZ8yQOSYwnfhLdSH+5qW7H87sn2okSZePZ+iqPIyOlVZFPFG3uygvpUukS5lYMTh5JHCSPbBJjXmCwP8JFJWGIEn5CcR3n7MP79z8UYLcoDHGPR4rxA0Oi79JAuZFeJCD1JYDe4XzVCpJqRWT0zbVX/2blEUzfND8oKz8Ju8dbQBk6ez/9+FPxjZjYBLDGp2I//PRj/qlYkvKDG5niyyafiPqUrwNBOtngKP9wbAiDeJdzlN+Snbu2YjvnmqrMzx8I5SkKyzMH8+CFu/9GM/beSC1L8hp+PR+/Lnx0klmP0zdtSxxazmmAO7MfywlqQh6vcE3A4cWtS87JdY3igF08jzuzXZZMu6QdZmcDRfjieS81n4QhnHqoELSck1Du8fYA5Bp+7cfYVYXsA6kkJP52ryhk31bl10dDZlfgyJsMqHVy676rMunFs1KvB0zZzw1K41MnprS6u13T7KzyFTSvRv8bAAD//7MdqP6GNgAA





- path: /etc/systemd/system/kubelet.service
  permissions: "0644"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/4ySz0/bThDF7/4rRhGH7/ewbOmPS5EPUAyNiCjCQRxChNbrgYyynnV3Z0No6f9emRAgYKT6ZM++z5vn1ZucM8k0O8BoA7VCnvPjVKFDyb55rqmbnBqZFUuKEnOdYtDOW+N0Raznj9Ism5QYFmRxmp1hFBMkN+7W3MWs4AUFzw2yHJLDXKNYXeO1SU6e+DJZizEWS5JSjKSY73z+lBVLtGXndRowf9hXmTgD7VvR5lcKqK1nMcQY4tpqO856uGZeUwDVgl6YoB1VT5v/RWuZ3suiLAzoGiaw9V/jEwvcw03AFi4HrzddDuAebi0o9z8oh/ABprALMkOG1doHXKmKuH4T8+1gF65p0Jf+0aYxc1RxZgK+dcs2OaVjR2IlpnIYQQmw6TwcRemVUvtayqnBQHYNPVPvNAYuM3h8lELu3FTEsMCwccK+RuVMhS7mg63fx+f7xagYX538OCiuRnv7xaj8M9gAFvlHUOqpFiokFmowD9h4QVDrgQr4M2EU1X34JPnOl6YPVMh164klT0zLr1rrkPi5dvWL1+3o7XwzjHepQdW6dEOsagqr8ndXEBgFo14pVoL4gt1a/+nhaO+o7Ds4K46G5bg4e7iLnvHFcPz9arw3PBmXWTYZchTj3DS7MCxY79/lTXJCKkUM22LCDcrfAAAA//8PqjOJCQQAAA==




- path: /etc/apt/apt.conf.d/99periodic
  permissions: "0644"
  owner: root
  content: |
    APT::Periodic::Update-Package-Lists "0";
    APT::Periodic::Download-Upgradeable-Packages "0";
    APT::Periodic::AutocleanInterval "0";
    APT::Periodic::Unattended-Upgrade "0";









- path: /etc/containerd/config.toml
  permissions: "0644"
  owner: root
  content: |
    version = 2
    subreaper = false
    oom_score = 0
    [plugins."io.containerd.grpc.v1.cri"]
      sandbox_image = "oss/kubernetes/pause:1.3.1"
      [plugins."io.containerd.grpc.v1.cri".containerd]
        
        snapshotter = "teleportd"
        disable_snapshot_annotations = false
        
        [plugins."io.containerd.grpc.v1.cri".containerd.untrusted_workload_runtime]
          runtime_type = "io.containerd.runtime.v1.linux"
          runtime_engine = "/usr/bin/runc"
        [plugins."io.containerd.grpc.v1.cri".containerd.default_runtime]
          runtime_type = "io.containerd.runtime.v1.linux"
          runtime_engine = "/usr/bin/runc"
      
      [plugins."io.containerd.grpc.v1.cri".cni]
        bin_dir = "/opt/cni/bin"
        conf_dir = "/etc/cni/net.d"
        conf_template = "/etc/containerd/kubenet_template.conf"
      
      [plugins."io.containerd.grpc.v1.cri".registry.headers]
        X-Meta-Source-Client = ["azure/aks"]
    [metrics]
      address = "127.0.0.1:10257"
    
    [proxy_plugins]
      [proxy_plugins.teleportd]
        type = "snapshot"
        address = "/run/teleportd/snapshotter.sock"
    
    #EOF

- path: /etc/containerd/kubenet_template.conf
  permissions: "0644"
  owner: root
  content: |
      {
          "cniVersion": "0.3.1",
          "name": "kubenet",
          "plugins": [{
            "type": "bridge",
            "bridge": "cbr0",
            "mtu": 1500,
            "addIf": "eth0",
            "isGateway": true,
            "ipMasq": false,
            "promiscMode": true,
            "hairpinMode": false,
            "ipam": {
                "type": "host-local",
                "subnet": "{{.PodCIDR}}",
                "routes": [{ "dst": "0.0.0.0/0" }]
            }
          },
          {
            "type": "portmap",
            "capabilities": {"portMappings": true},
            "externalSetMarkChain": "KUBE-MARK-MASQ"
          }]
      }

- path: /etc/systemd/system/containerd.service
  permissions: "0644"
  owner: root
  content: |
    [Unit]
    Description=containerd daemon
    After=network.target

    [Service]
    ExecStartPre=/sbin/modprobe overlay
    ExecStart=/usr/bin/containerd
    Delegate=yes
    KillMode=process
    Restart=always
    OOMScoreAdjust=-999
    LimitNOFILE=1048576
    LimitNPROC=infinity
    LimitCORE=infinity

    [Install]
    WantedBy=multi-user.target

    #EOF

- path: /etc/systemd/system/containerd.service.d/exec_start.conf
  permissions: "0644"
  owner: root
  content: |
    [Service]
    ExecStartPost=/sbin/iptables -P FORWARD ACCEPT
    #EOF

- path: /etc/crictl.yaml
  permissions: "0644"
  owner: root
  content: |
    runtime-endpoint: unix:///run/containerd/containerd.sock
    #EOF

- path: /etc/sysctl.d/11-containerd.conf
  permissions: "0644"
  owner: root
  content: |
    net.ipv4.ip_forward = 1
    net.ipv4.conf.all.forwarding = 1
    net.bridge.bridge-nf-call-iptables = 1
    #EOF


- path: /etc/systemd/system/teleportd.service
  permissions: "0644"
  owner: root
  content: |
    [Unit]
    Description=teleportd teleport runtime
    After=network.target
    [Service]
    ExecStart=/usr/local/bin/teleportd --metrics --aksConfig /etc/kubernetes/azure.json
    Delegate=yes
    KillMode=process
    Restart=always
    LimitNPROC=infinity
    LimitCORE=infinity
    LimitNOFILE=1048576
    TasksMax=infinity
    [Install]
    WantedBy=multi-user.target
    #EOF





- path: /etc/kubernetes/certs/ca.crt
  permissions: "0644"
  encoding: base64
  owner: root
  content: |
    

- path: /etc/kubernetes/certs/client.crt
  permissions: "0644"
  encoding: base64
  owner: root
  content: |
    



- path: /var/lib/kubelet/kubeconfig
  permissions: "0644"
  owner: root
  content: |
    apiVersion: v1
    kind: Config
    clusters:
    - name: localcluster
      cluster:
        certificate-authority: /etc/kubernetes/certs/ca.crt
        server: https://:443
    users:
    - name: client
      user:
        client-certificate: /etc/kubernetes/certs/client.crt
        client-key: /etc/kubernetes/certs/client.key
    contexts:
    - context:
        cluster: localcluster
        user: client
      name: localclustercontext
    current-context: localclustercontext
    #EOF

- path: /etc/default/kubelet
  permissions: "0644"
  owner: root
  content: |
    KUBELET_FLAGS=
    KUBELET_REGISTER_SCHEDULABLE=true
    NETWORK_POLICY=

    KUBELET_NODE_LABELS=kubernetes.azure.com/role=agent,agentpool=agent2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName

    #EOF

- path: /opt/azure/containers/kubelet.sh
  permissions: "0755"
  owner: root
  content: |
    #!/bin/bash


    # Disallow container from reaching out to the special IP address 168.63.129.16
    # for TCP protocol (which http uses)
    #
    # 168.63.129.16 contains protected settings that have priviledged info.
    #
    # The host can still reach 168.63.129.16 because it goes through the OUTPUT chain, not FORWARD.
    #
    # Note: we should not block all traffic to 168.63.129.16. For example UDP traffic is still needed
    # for DNS.
    iptables -I FORWARD -d 168.63.129.16 -p tcp --dport 80 -j DROP
    #EOF

- path: /etc/sysctl.d/999-sysctl-aks.conf
  permissions: "0644"
  owner: root
  content: |
    # This is a partial workaround to this upstream Kubernetes issue:
    # https://github.com/kubernetes/kubernetes/issues/41916#issuecomment-312428731
    net.ipv4.tcp_retries2=8
    net.core.message_burst=80
    net.core.message_cost=40
    net.core.somaxconn=16384
    net.ipv4.tcp_max_syn_backlog=16384
    net.ipv4.neigh.default.gc_thresh1=4096
    net.ipv4.neigh.default.gc_thresh2=8192
    net.ipv4.neigh.default.gc_thresh3=16384

    #EOF

runcmd:
- set -x
- . /opt/azure/containers/provision_source.sh
- . /opt/azure/containers/provision_source_distro.sh
- aptmarkWALinuxAgent hold
