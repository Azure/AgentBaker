<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "20.10.6"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "aks-subnet"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-36873793"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "10.240.0.0/16"
$global:KubeServiceCIDR = "10.0.0.0/16"
$global:VNetCIDR = "10.0.0.0/8"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2019-17763.1577.201111"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=10.0.0.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "true"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("false");

# Calico
$global:WindowsCalicoPackageURL = "";

# GMSA
$global:WindowsGmsaPackageUrl = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"
$fipsEnabled = [System.Convert]::ToBoolean("false")
$windowsSecureTlsEnabled = [System.Convert]::ToBoolean("false");

try
{
        # Exit early if the script has been executed
        if (Test-Path -Path $CSEResultFilePath -PathType Leaf) {
            Write-Log "The script has been executed before, will exit without doing anything."
            return
        }

        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Write-Log "Remove `"NT AUTHORITY\Authenticated Users`" write permissions on files in c:\k"
        icacls.exe "c:\k" /inheritance:r
        icacls.exe "c:\k" /grant:r SYSTEM:`(OI`)`(CI`)`(F`)
        icacls.exe "c:\k" /grant:r BUILTIN\Administrators:`(OI`)`(CI`)`(F`)
        icacls.exe "c:\k" /grant:r BUILTIN\Users:`(OI`)`(CI`)`(RX`)
        Write-Log "c:\k permissions: "
        icacls.exe "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment $TargetEnvironment 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        Write-Log "Installing Azure VNet plugins"
        Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
            -AzureCNIBinDir $global:AzureCNIBinDir `
            -VNetCNIPluginsURL $global:VNetCNIPluginsURL

        Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
            -KubeDnsSearchPath $global:KubeDnsSearchPath `
            -KubeClusterCIDR $global:KubeClusterCIDR `
            -KubeServiceCIDR $global:KubeServiceCIDR `
            -VNetCIDR $global:VNetCIDR `
            -IsDualStackEnabled $global:IsDualStackEnabled

        if ($TargetEnvironment -ieq "AzureStackCloud") {
            GenerateAzureStackCNIConfig `
                -TenantId $global:TenantId `
                -SubscriptionId $global:SubscriptionId `
                -ResourceGroup $global:ResourceGroup `
                -AADClientId $AADClientId `
                -KubeDir $global:KubeDir `
                -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                -NetworkAPIVersion $NetworkAPIVersion `
                -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                -IdentitySystem "azure_ad"
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime
        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Update-DefenderPreferences

        if ($windowsSecureTlsEnabled) {
            Write-Host "Enable secure TLS protocols"
            try {
                . C:\k\windowssecuretls.ps1
                Enable-SecureTls
            }
            catch {
                Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_ENABLE_SECURE_TLS -ErrorMessage $_
            }
        }

        Enable-FIPSMode -FipsEnabled $fipsEnabled
        if ($global:WindowsGmsaPackageUrl) {
            Write-Log "Start to install Windows gmsa package"
            Install-GmsaPlugin -GmsaPackageUrl $global:WindowsGmsaPackageUrl
        }

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

