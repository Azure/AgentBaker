#!/bin/bash
# Mock dig for DNS resolution failure
case "$*" in
    *mcr.microsoft.com*|*kubernetes.default.svc.cluster.local*|*example.microsoft.com*)
        # Simulate DNS resolution failure
        cat <<END >&2
; <<>> DiG 9.16.1 <<>> mcr.microsoft.com @168.63.129.16
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 12345
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1

;; QUESTION SECTION:
;mcr.microsoft.com.             IN      A

;; Query time: 5000 msec
;; SERVER: 168.63.129.16#53(168.63.129.16)
;; WHEN: Mon Jul 15 10:00:00 UTC 2025
;; MSG SIZE  rcvd: 43
END
        exit 9
        ;;
    *)
        echo "Mock dig: unknown query: $*" >&2
        exit 1
        ;;
esac
