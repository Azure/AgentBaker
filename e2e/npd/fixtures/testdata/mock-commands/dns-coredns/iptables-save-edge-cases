#!/bin/bash
# Mock iptables-save with edge case IP formats for regex testing
case "$*" in
    *"-t nat"*)
        cat <<END
# Generated by iptables-save v1.8.4 on Mon Jul 15 10:00:00 2025
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:KUBE-SERVICES - [0:0]
-A PREROUTING -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
-A OUTPUT -m comment --comment "kubernetes service portals" -j KUBE-SERVICES
-A KUBE-SERVICES -d 1.2.3.4/32 -p tcp -m comment --comment "kube-system/kube-dns:dns-tcp cluster IP" -j KUBE-SVC-TEST
-A KUBE-SERVICES -d 192.168.100.200/32 -p udp -m comment --comment "kube-system/kube-dns cluster IP" -j KUBE-SVC-TEST2
COMMIT
# Completed on Mon Jul 15 10:00:00 2025
END
        ;;
    *)
        echo "Mock iptables-save: unknown args: $*" >&2
        exit 1
        ;;
esac
